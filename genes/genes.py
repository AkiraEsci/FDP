#AID
#genes = ["ADA2", "ADAR", "ALPK1", "ARPC5", "ATAD3A", "C2ORF69", "CDC42", "DDX58", "DOCK11", "DPP9", "ELF4", "F12", "HCK", "HOIL1", "HOIP", "IFIH1", "IKBKG", "IL1R1", "IL1RN", "IL36RN", "ISG15", "JAK1", "LSM11", "MEFV", "MVK", "NLRC4", "NLRP1", "NLRP3", "NOD2", "OAS1", "OTULIN", "PLCG2", "PMVK", "POMP", "PSMA", "PSMB10", "PSMB4", "PSMB8", "PSMB9", "PSMD12", "PSMG2", "PSTPIP1", "RBCK1", "RELA", "RIPK1", "RNASEH2A", "RNASEH2B", "RNASEH2C", "RNF31", "RNU7â€“1", "SAMHD1", "SOCS1", "STAT2", "STAT5", "STING", "SYK", "TBK1", "TLR7", "TLR8", "TMEM173", "TNFAIP3", "TNFRSF1A", "TREX1", "TRNT1", "UBA1", "USP18", "WDR1"]
#CVID
#genes = ["ACP5", "CD79A", "IL21", "PRKCD", "AICDA", "CD79B", "IL21R", "RAC2", "AIRE", "CD81", "IL2RA", "RAD50", "ANP32B", "CD84", "IL3", "RAG1", "BCL2", "CD93", "IL4", "RAG2", "BLK", "CECR1", "IL4R", "SERPINA1", "BLNK", "CLEC16A", "INFG", "SH2D1A", "BTK", "CR2", "IRF2BP2", "STAT1", "BTLA", "CTLA4", "ITCH", "STAT3", "CARD11", "DOCK8", "LRBA", "TNFRSF13B", "CASP8", "FCER2", "MBL2", "TNFRSF13C", "CD19", "FCGR2A", "MLH1", "TNFRSF17", "CD20", "FOXP3", "MS4A1", "TNFRSF7", "CD22", "HLA-DQ", "MSH2", "TNFSF10", "CD24", "HLA-DR", "MSH5", "TNFSF12", "CD27", "ICOS", "NFKB1", "TNFSF13", "CD274", "ICOSLG", "NFKB2", "TNFSF13B", "CD276", "IGHM", "NOD2", "UNC93B1", "CD37", "IGKC", "ORC4L", "UNG", "CD38", "IGLL1", "PDCD1", "VAV1", "CD40", "IKZF1", "PDCD1LG2", "VDR", "CD40LG", "IL10", "PIK3CD", "XIAP", "CD5", "IL10RA", "PIK3R1", "CD72", "IL10RB", "PLCG2", "CD74", "IL12", "PMS2"]
#IEI
genes = ["ACD", "ACP5", "ACTB", "ADA", "ADA2", "ADAM17", "ADAMTS13", "ADAR", "ADGRE2", "AICDA", "AIRE", "AK2", "AKT1", "ALG6", "ALPI", "ALPK1", "ANGPT1", "ANKRD26", "ANKZF1", "AP1S3", "AP3B1", "AP3D1", "AP4E1", "APOL1", "ARF6", "ARHGAP21", "ARHGEF1", "ARHGEF6", "ARPC1B", "ARPC5", "ASAH1", "ATAD3A", "ATG4A", "ATM", "ATP6AP1", "B2M", "BACH2", "BCL10", "BCL11B", "BLM", "BLNK", "BLOC1S3", "BLOC1S6", "BRAF", "BRCA1", "BRCA2", "BRIP1", "BTK", "C1QA", "C1QB", "C1QC", "C1R", "C1S", "C2", "C2orf69", "C3", "C4A", "C4B", "C4BPA", "C4BPB", "C5", "C6", "C7", "C8A", "C8B", "C8G", "C9", "CADPS2", "CARD11", "CARD14", "CARD8", "CARD9", "CARMIL2", "CASP10", "CASP8", "CBL", "CCBE1", "CCDC141", "CD19", "CD247", "CD27", "CD28", "CD3D", "CD3E", "CD3G", "CD40", "CD40LG", "CD46", "CD48", "CD55", "CD59", "CD70", "CD79A", "CD79B", "CD81", "CD8A", "CDC42", "CDCA7", "CEBPE", "CFB", "CFD", "CFH", "CFHR1", "CFHR2", "CFHR3", "CFHR4", "CFHR5", "CFI", "CFP", "CFTR", "CHD7", "CHUK", "CIB1", "CIITA", "CLCN7", "CLEC7A", "CLPB", "COL7A1", "COLEC11", "COPA", "COPG1", "CORO1A", "CR2", "CRACR2A", "CSF2RA", "CSF2RB", "CSF3R", "CTC1", "CTLA4", "CTNNBL1", "CTPS1", "CTSC", "CXCR2", "CXCR4", "CYBA", "CYBB", "CYBC1", "CYP27A1", "DBF4", "DBR1", "DCLRE1B", "DCLRE1C", "DDX58", "DEF6", "DEPTOR", "DGAT1", "DGKE", "DIAPH1", "DKC1", "DNAJC21", "DNASE1L3", "DNASE2", "DNMT3B", "DOCK2", "DOCK8", "DSG1", "DTNBP1", "DUOX2", "EFL1", "EIF2AK3", "ELANE", "ELF4", "EPG5", "ERBIN", "ERCC2", "ERCC3", "ERCC4", "ERCC6L2", "EXPH5", "EXTL3", "F12", "FAAP24", "FADD", "FANCA", "FANCB", "FANCC", "FANCD2", "FANCE", "FANCF", "FANCG", "FANCI", "FANCL", "FANCM", "FAS", "FASLG", "FAT4", "FCGR1A", "FCGR2A", "FCGR2B", "FCGR3A", "FCGR3B", "FCGRT", "FCHO1", "FCN3", "FERMT1", "FERMT3", "FKBPL", "FNIP1", "FOXI3", "FOXN1", "FOXP3", "FPR1", "G3BP1", "G6PC1", "G6PC3", "G6PD", "GATA1", "GATA2", "GDI1", "GFI1", "GIMAP5", "GIMAP6", "GINS1", "GINS4", "GNLY", "GP1BA", "GTF2E2", "GTF2H5", "GUCY2C", "GZMB", "HAVCR2", "HAX1", "HCK", "HELLS", "HMOX1", "HPS1", "HPS3", "HPS4", "HPS5", "HPS6", "HTR1A", "HTRA2", "HYOU1", "ICOS", "ICOSLG", "IFIH1", "IFNAR1", "IFNAR2", "IFNG", "IFNGR1", "IFNGR2", "IGHA1", "IGHG2", "IGHM", "IGKC", "IGLL1", "IKBKB", "IKBKG", "IKZF1", "IKZF2", "IKZF3", "IL10", "IL10RA", "IL10RB", "IL12B", "IL12RB1", "IL12RB2", "IL16", "IL17F", "IL17RA", "IL17RC", "IL18", "IL18BP", "IL1RN", "IL21", "IL21R", "IL23R", "IL2RA", "IL2RB", "IL2RG", "IL36RN", "IL6R", "IL6ST", "IL7R", "INO80", "IPO8", "IRAK1", "IRAK4", "IRF1", "IRF2BP2", "IRF3", "IRF4", "IRF7", "IRF8", "IRF9", "ISG15", "ITCH", "ITGAM", "ITGB2", "ITK", "ITPKB", "ITPR3", "JAGN1", "JAK1", "JAK2", "JAK3", "KAT6A", "KDM6A", "KLF2", "KMT2A", "KMT2D", "KRAS", "LACC1", "LAMP1", "LAMTOR2", "LAT", "LCK", "LCP2", "LCT", "LIG1", "LIG4", "LIPA", "LMNA", "LPIN2", "LRBA", "LRGUK", "LRRC8A", "LSM11", "LYN", "LYST", "MAD2L2", "MAGT1", "MALT1", "MAN2B2", "MAP1LC3B2", "MAP3K14", "MAPK8", "MASP1", "MASP2", "MBL2", "MCM10", "MCM3AP", "MCM4", "MCM9", "MECOM", "MEFV", "MICAL2", "MLPH", "MMACHC", "MOGS", "MPLKIP", "MPO", "MRE11", "MRTFA", "MS4A1", "MS4A2", "MSH6", "MSN", "MTHFD1", "MVK", "MYD88", "MYO5A", "MYO5B", "MYOF", "MYSM1", "NBAS", "NBN", "NCF1", "NCF2", "NCF4", "NCKAP1L", "NCSTN", "NEIL3", "NEUROG3", "NFAT5", "NFE2L2", "NFKB1", "NFKB2", "NFKBIA", "NFKBID", "NHEJ1", "NHP2", "NLRC3", "NLRC4", "NLRP1", "NLRP12", "NLRP13", "NLRP3", "NLRP4", "NOD2", "NOP10", "NOS2", "NRAS", "NSMCE3", "OAS1", "ORAI1", "OSTM1", "OTULIN", "PALB2", "PARN", "PAX1", "PAX5", "PDCD1", "PEPD", "PGM3", "PIGA", "PIK3CD", "PIK3CG", "PIK3R1", "PLCG2", "PLEKHM1", "PLG", "PLVAP", "PMM2", "PMS2", "PNLIP", "PNP", "POLA1", "POLD1", "POLD2", "POLE", "POLE2", "POLR3A", "POLR3C", "POLR3F", "POMP", "POU2AF1", "PRF1", "PRKCD", "PRKDC", "PSEN1", "PSENEN", "PSMA3", "PSMB10", "PSMB4", "PSMB8", "PSMB9", "PSMG2", "PSTPIP1", "PTEN", "PTPRC", "PTPRJ", "RAB27A", "RAC2", "RAD51", "RAD51C", "RAG1", "RAG2", "RANBP2", "RASGRP1", "RASGRP2", "RASGRP3", "RBCK1", "RBM8A", "RC3H1", "RECQL4", "REL", "RELA", "RELB", "RFWD3", "RFX5", "RFXANK", "RFXAP", "RGS10", "RHOG", "RHOH", "RIPK1", "RMRP", "RNASEH2A", "RNASEH2B", "RNASEH2C", "RNF113A", "RNF168", "RNF31", "RNU4ATAC", "RNU7-1", "RORC", "RPSA", "RTEL1", "SAMD9", "SAMD9L", "SAMHD1", "SAR1B", "SASH3", "SBDS", "SCO2", "SEC61A1", "SEMA3E", "SERPING1", "SGPL1", "SH2D1A", "SH3BP2", "SH3KBP1", "SI", "SIAE", "SKIC2", "SKIC3", "SLC10A2", "SLC11A1", "SLC26A3", "SLC29A3", "SLC35C1", "SLC37A4", "SLC39A7", "SLC46A1", "SLC51B", "SLC5A1", "SLC7A7", "SLC9A3", "SLX4", "SMARCAL1", "SMARCD2", "SNORA31", "SNX10", "SOCS1", "SP110", "SPI1", "SPINK5", "SPINT2", "SPPL2A", "SPTA1", "SRGN", "SRP54", "SRP72", "STAT1", "STAT2", "STAT3", "STAT4", "STAT5B", "STIM1", "STING1", "STK4", "STN1", "STX11", "STX3", "STXBP2", "STXBP3", "SYK", "TAFAZZIN", "TAOK2", "TAP1", "TAP2", "TAPBP", "TASP1", "TBK1", "TBX1", "TBX21", "TCF3", "TCIRG1", "TCN2", "TERC", "TERT", "TET2", "TFR2", "TFRC", "TGFB1", "TGFBR1", "TGFBR2", "THBD", "TICAM1", "TIMM50", "TINF2", "TIRAP", "TLR3", "TLR7", "TLR8", "TMC6", "TMC8", "TMPRSS15", "TNFAIP3", "TNFRSF10B", "TNFRSF11A", "TNFRSF13B", "TNFRSF13C", "TNFRSF1A", "TNFRSF4", "TNFRSF6B", "TNFRSF9", "TNFSF11", "TNFSF12", "TNFSF13", "TOM1", "TONSL", "TOP2B", "TP53", "TP63", "TPP2", "TRAC", "TRAF3", "TRAF3IP2", "TREM2", "TREX1", "TRIM22", "TRNT1", "TTC7A", "TYK2", "UBA1", "UBE2T", "UNC119", "UNC13D", "UNC45A", "UNC93B1", "UNG", "USB1", "USP18", "VAV1", "VPREB1", "VPS13B", "VPS45", "VWF", "WAS", "WASF2", "WDR1", "WIPF1", "WNT2B", "WRAP53", "XIAP", "XIRP2", "XRCC2", "XRCC4", "ZAP70", "ZBTB24", "ZCCHC8", "ZNF341", "ZNFX1"]


gene_individual_map = {}
for i in ["melt", "scramble", "mobster"]:
    file_path = f"/gpfs42/projects/lab_genresearch/shared_data/ahirata/Results/exp_obs_gene_VH_{i}.csv"
    with open(file_path, 'r') as tsv_file:
        next(tsv_file)
        for line in tsv_file:
            columns = line.strip().split(',')
            gene_name = str(columns[6])
            chromosome = str(columns[1])
            individual_name = str(columns[0])
            distance_to_exon = str(columns[4])
            distance_tag = str(columns[5])
            if i == "scramble":
                exon = str(columns[7])
            else:
                exon = str(columns[8])
            if gene_name in genes:
                if individual_name not in gene_individual_map:
                    gene_individual_map[individual_name] = []
                gene_individual_map[individual_name].append((gene_name, distance_to_exon, distance_tag, exon, i, chromosome))

with open('genes_VH.csv', 'w') as csv_file:
    csv_file.write("Individual,Gene_name,Distance,Distance_tag,Exon,Tool,Chromosome\n")
    for individual, gene_info_list in gene_individual_map.items():
        for gene_info in gene_info_list:
            gene, distance, tag, exon, tool, chromosome = gene_info
            csv_file.write(f"{individual},{gene},{distance},{tag},{exon},{tool},{chromosome}\n")

